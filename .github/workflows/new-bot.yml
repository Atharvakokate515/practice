name: Daily Commits (6-7 per day)

permissions:
  contents: write     # <----- REQUIRED

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

jobs:
  commits:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}   # <---- REQUIRED

      - name: Generate 6-7 Commits
        run: |
          COMMITS=$(( 6 + RANDOM % 2 ))
          echo "Today's commit target: $COMMITS"

          for ((i=1; i<=COMMITS; i++)); do
            echo "Commit $i at $(date)" >> activity.txt

            git config --local user.email "katharva515@gmail.com"
            git config --local user.name "Atharvakokate515"

            git add .
            git commit -m "Automated commit $i"

            SLEEP_TIME=$(( 300 + RANDOM % 3600 ))
            echo "Sleeping for $SLEEP_TIME seconds..."
            sleep $SLEEP_TIME
          done

      - name: Push changes
        run: git push origin HEAD:${{ github.ref_name }}
